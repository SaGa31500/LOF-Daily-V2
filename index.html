<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Orchestration Framework - Daily Check-In</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #fafafa;
            color: #333;
            line-height: 1.6;
            touch-action: manipulation;
        }

        .container {
            max-width: 100vw;
            min-height: 100vh;
            background: white;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 0 0 20px 20px;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .header .subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .screen {
            display: none;
            flex: 1;
            padding: 30px 20px;
            animation: slideIn 0.3s ease-out;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .screen-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 24px;
            text-align: center;
            color: #333;
        }

        .energy-grid {
            display: grid;
            gap: 20px;
            margin-bottom: 30px;
        }

        .energy-type {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .energy-type.physical { border-color: #3498db; }
        .energy-type.mental { border-color: #2ecc71; }
        .energy-type.emotional { border-color: #e67e22; }
        .energy-type.mood { border-color: #9b59b6; }

        .energy-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .energy-icons {
            font-size: 24px;
        }

        .energy-slider {
            position: relative;
            height: 50px;
            background: #e9ecef;
            border-radius: 25px;
            overflow: hidden;
            touch-action: pan-x;
        }

        .energy-fill {
            height: 100%;
            border-radius: 25px;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
        }

        .energy-fill.physical { background: #3498db; }
        .energy-fill.mental { background: #2ecc71; }
        .energy-fill.emotional { background: #e67e22; }
        .energy-fill.mood { background: #9b59b6; }

        .mode-selection {
            display: grid;
            gap: 16px;
            margin-bottom: 30px;
        }

        .mode-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .mode-card:hover, .mode-card.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .mode-card .mode-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .mode-card .mode-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .mode-card .mode-desc {
            font-size: 14px;
            opacity: 0.8;
        }

        .wheel-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 30px;
        }

        .wheel-area {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: all 0.2s ease;
        }

        .wheel-area.lowest {
            border-color: #e74c3c;
            background: #fdf2f2;
        }

        .wheel-icon {
            font-size: 28px;
            margin-bottom: 8px;
        }

        .wheel-label {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .wheel-rating {
            display: flex;
            justify-content: center;
            gap: 4px;
        }

        .wheel-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .wheel-dot.filled {
            background: #667eea;
        }

        .suggestion-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .suggestion-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .suggestion-text {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .suggestion-desc {
            font-size: 14px;
            opacity: 0.9;
        }

        .task-input {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 16px;
            font-size: 16px;
            width: 100%;
            margin-bottom: 20px;
            min-height: 80px;
            resize: vertical;
        }

        .task-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 24px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 56px;
            margin-top: auto;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: #6c757d;
            margin-bottom: 12px;
        }

        .progress-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .progress-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #ddd;
            transition: all 0.2s ease;
        }

        .progress-dot.active {
            background: #667eea;
            width: 20px;
            border-radius: 4px;
        }

        .summary-grid {
            display: grid;
            gap: 16px;
            margin-bottom: 30px;
        }

        .summary-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .summary-icon {
            font-size: 24px;
            width: 40px;
            text-align: center;
        }

        .summary-text {
            flex: 1;
        }

        .summary-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .summary-desc {
            font-size: 14px;
            opacity: 0.7;
        }

        .output-box {
            background: #f1f3f4;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .copy-btn {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin-bottom: 12px;
        }

        .copy-btn:hover {
            background: #218838;
        }

        @media (max-width: 480px) {
            .container {
                font-size: 16px;
            }
            
            .screen {
                padding: 20px 16px;
            }
            
            .header {
                padding: 16px;
            }
            
            .wheel-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Life Orchestration</h1>
            <div class="subtitle">Daily Check-In</div>
        </div>

        <!-- Screen 1: Energy Assessment -->
        <div class="screen active" id="energy-screen">
            <div class="screen-title">How's your energy today?</div>
            
            <div class="energy-grid">
                <div class="energy-type physical">
                    <div class="energy-label">
                        <span class="energy-icons">💪</span>
                        Physical
                    </div>
                    <div class="energy-slider" data-type="physical">
                        <div class="energy-fill physical" style="width: 60%">3/5</div>
                    </div>
                </div>

                <div class="energy-type mental">
                    <div class="energy-label">
                        <span class="energy-icons">🧠</span>
                        Mental
                    </div>
                    <div class="energy-slider" data-type="mental">
                        <div class="energy-fill mental" style="width: 80%">4/5</div>
                    </div>
                </div>

                <div class="energy-type emotional">
                    <div class="energy-label">
                        <span class="energy-icons">❤️</span>
                        Emotional
                    </div>
                    <div class="energy-slider" data-type="emotional">
                        <div class="energy-fill emotional" style="width: 40%">2/5</div>
                    </div>
                </div>

                <div class="energy-type mood">
                    <div class="energy-label">
                        <span class="energy-icons">😊</span>
                        Mood
                    </div>
                    <div class="energy-slider" data-type="mood">
                        <div class="energy-fill mood" style="width: 60%">3/5</div>
                    </div>
                </div>
            </div>

            <div class="progress-dots">
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>

            <button class="btn" onclick="goToModeSelection()">Continue ▶</button>
        </div>

        <!-- Screen 2: Mode Selection -->
        <div class="screen" id="mode-screen">
            <div class="screen-title">Energy Sum: <span id="energy-sum">12/20</span></div>
            
            <div class="mode-selection">
                <div class="mode-card" data-mode="maintenance" onclick="selectMode('maintenance')">
                    <div class="mode-icon">🔄</div>
                    <div class="mode-title">Maintenance</div>
                    <div class="mode-desc">Quick wins & life areas</div>
                </div>

                <div class="mode-card" data-mode="recovery" onclick="selectMode('recovery')">
                    <div class="mode-icon">😴</div>
                    <div class="mode-title">Recovery</div>
                    <div class="mode-desc">Rest & recharge</div>
                </div>

                <div class="mode-card" data-mode="progress" onclick="selectMode('progress')">
                    <div class="mode-icon">🚀</div>
                    <div class="mode-title">Progress</div>
                    <div class="mode-desc">Complex projects</div>
                </div>
            </div>

            <div class="progress-dots">
                <div class="progress-dot"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>

            <button class="btn-secondary btn" onclick="showScreen('energy-screen')">◀ Back to Energy</button>
            <button class="btn" id="mode-continue-btn" onclick="goToWheelCheck()" disabled style="opacity: 0.5;">Select Mode First</button>
        </div>

        <!-- Screen 3: Wheel Check-In -->
        <div class="screen" id="wheel-screen">
            <div class="screen-title">Life Area Quick Check</div>
            
            <div class="wheel-grid">
                <div class="wheel-area" data-area="body">
                    <div class="wheel-icon">👤</div>
                    <div class="wheel-label">Body</div>
                    <div class="wheel-rating" data-area="body">
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot"></div>
                        <div class="wheel-dot"></div>
                        <div class="wheel-dot"></div>
                    </div>
                </div>

                <div class="wheel-area lowest" data-area="space">
                    <div class="wheel-icon">🏠</div>
                    <div class="wheel-label">Space</div>
                    <div class="wheel-rating" data-area="space">
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot"></div>
                        <div class="wheel-dot"></div>
                        <div class="wheel-dot"></div>
                        <div class="wheel-dot"></div>
                    </div>
                </div>

                <div class="wheel-area" data-area="love">
                    <div class="wheel-icon">❤️</div>
                    <div class="wheel-label">Love</div>
                    <div class="wheel-rating" data-area="love">
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot"></div>
                    </div>
                </div>

                <div class="wheel-area" data-area="security">
                    <div class="wheel-icon">🛡️</div>
                    <div class="wheel-label">Security</div>
                    <div class="wheel-rating" data-area="security">
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot"></div>
                        <div class="wheel-dot"></div>
                    </div>
                </div>

                <div class="wheel-area" data-area="purpose">
                    <div class="wheel-icon">🎯</div>
                    <div class="wheel-label">Purpose</div>
                    <div class="wheel-rating" data-area="purpose">
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot"></div>
                        <div class="wheel-dot"></div>
                    </div>
                </div>

                <div class="wheel-area" data-area="joy">
                    <div class="wheel-icon">😊</div>
                    <div class="wheel-label">Joy</div>
                    <div class="wheel-rating" data-area="joy">
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot filled"></div>
                        <div class="wheel-dot"></div>
                        <div class="wheel-dot"></div>
                        <div class="wheel-dot"></div>
                    </div>
                </div>
            </div>

            <div class="suggestion-box">
                <div class="suggestion-icon">💡</div>
                <div class="suggestion-text">Suggested Focus: Space</div>
                <div class="suggestion-desc">Lowest area - quick kitchen cleanup could boost energy</div>
            </div>

            <div class="progress-dots">
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
            </div>

            <button class="btn-secondary btn" onclick="showScreen('mode-screen')">◀ Back to Mode</button>
            <button class="btn" onclick="goToTaskPlanning()">Plan Task ▶</button>
        </div>

        <!-- Screen 4: Task Planning -->
        <div class="screen" id="task-screen">
            <div class="screen-title">Today's Focus</div>
            
            <textarea class="task-input" placeholder="What will you work on today? (Keep it simple - 1-3 things max)" id="task-input">Quick kitchen cleanup - dishes, counter wipe, maybe prep coffee for tomorrow</textarea>

            <div class="summary-grid">
                <div class="summary-item">
                    <div class="summary-icon">⚡</div>
                    <div class="summary-text">
                        <div class="summary-title">Energy Available</div>
                        <div class="summary-desc">Medium capacity, good for maintenance tasks</div>
                    </div>
                </div>

                <div class="summary-item">
                    <div class="summary-icon">🎯</div>
                    <div class="summary-text">
                        <div class="summary-title">Focus Area</div>
                        <div class="summary-desc">Space improvement (lowest wheel area)</div>
                    </div>
                </div>

                <div class="summary-item">
                    <div class="summary-icon">🔄</div>
                    <div class="summary-text">
                        <div class="summary-title">Mode</div>
                        <div class="summary-desc">Maintenance - sustainable daily wins</div>
                    </div>
                </div>
            </div>

            <div class="progress-dots">
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot active"></div>
            </div>

            <button class="btn-secondary btn" onclick="showScreen('wheel-screen')">◀ Back to Wheel</button>
            <button class="btn" onclick="generateOutput()">Complete Planning ▶</button>
        </div>

        <!-- Screen 5: Output -->
        <div class="screen" id="output-screen">
            <div class="screen-title">Session Complete!</div>
            
            <div class="output-box" id="output-text"></div>
            
            <button class="copy-btn" onclick="copyToClipboard()">📋 Copy for C12 Analysis</button>
            <button class="btn-secondary btn" onclick="startEvening()">Evening Review Later</button>
            <button class="btn" onclick="restart()">New Day ▶</button>
        </div>
    </div>

    <script>
        let appData = {
            energy: { physical: 3, mental: 4, emotional: 2, mood: 3 },
            mode: '',
            wheelRatings: { body: 2, space: 1, love: 4, security: 3, purpose: 3, joy: 2 },
            tasks: '',
            session: 'morning'
        };

        // Energy slider interaction
        document.addEventListener('DOMContentLoaded', function() {
            const sliders = document.querySelectorAll('.energy-slider');
            sliders.forEach(slider => {
                slider.addEventListener('click', handleSliderClick);
                slider.addEventListener('touchstart', handleSliderTouch);
            });

            // Wheel rating interaction
            const wheelRatings = document.querySelectorAll('.wheel-rating');
            wheelRatings.forEach(rating => {
                const dots = rating.querySelectorAll('.wheel-dot');
                dots.forEach((dot, index) => {
                    dot.addEventListener('click', () => updateWheelRating(rating.dataset.area, index + 1));
                });
            });

            updateEnergySum();
        });

        function handleSliderClick(e) {
            updateSlider(e.target.closest('.energy-slider'), e.clientX);
        }

        function handleSliderTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            updateSlider(e.target.closest('.energy-slider'), touch.clientX);
        }

        function updateSlider(slider, clientX) {
            const rect = slider.getBoundingClientRect();
            const percentage = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
            const value = Math.ceil(percentage * 5);
            const energyType = slider.dataset.type;
            
            appData.energy[energyType] = value;
            
            const fill = slider.querySelector('.energy-fill');
            fill.style.width = (value * 20) + '%';
            fill.textContent = value + '/5';
            
            updateEnergySum();
        }

        function updateEnergySum() {
            const sum = Object.values(appData.energy).reduce((a, b) => a + b, 0);
            document.getElementById('energy-sum').textContent = sum + '/20';
            
            // Auto-suggest mode based on energy
            const modeCards = document.querySelectorAll('.mode-card');
            modeCards.forEach(card => card.classList.remove('selected'));
            
            let suggestedMode = 'maintenance';
            if (sum <= 8) suggestedMode = 'recovery';
            if (sum >= 16) suggestedMode = 'progress';
            
            document.querySelector(`[data-mode="${suggestedMode}"]`).classList.add('selected');
            appData.mode = suggestedMode;
            
            const continueBtn = document.getElementById('mode-continue-btn');
            continueBtn.disabled = false;
            continueBtn.style.opacity = '1';
            continueBtn.textContent = `Continue with ${suggestedMode.charAt(0).toUpperCase() + suggestedMode.slice(1)} ▶`;
        }

        function updateWheelRating(area, rating) {
            appData.wheelRatings[area] = rating;
            
            const ratingEl = document.querySelector(`[data-area="${area}"] .wheel-rating`);
            const dots = ratingEl.querySelectorAll('.wheel-dot');
            
            dots.forEach((dot, index) => {
                dot.classList.toggle('filled', index < rating);
            });
            
            // Update lowest area highlighting
            const lowest = Object.entries(appData.wheelRatings).reduce((a, b) => a[1] < b[1] ? a : b);
            document.querySelectorAll('.wheel-area').forEach(area => area.classList.remove('lowest'));
            document.querySelector(`[data-area="${lowest[0]}"]`).classList.add('lowest');
            
            // Update suggestion
            const suggestions = {
                body: 'Self-care routine - shower, grooming, or gentle movement',
                space: 'Quick cleanup - dishes, counter wipe, or organize one area',
                love: 'Connection time - call someone or quality time with partner',
                security: 'Financial check-in or important document organization',
                purpose: 'Small progress on meaningful project or goal reflection',
                joy: 'Something fun - music, creative activity, or favorite hobby'
            };
            
            document.querySelector('.suggestion-text').textContent = `Suggested Focus: ${lowest[0].charAt(0).toUpperCase() + lowest[0].slice(1)}`;
            document.querySelector('.suggestion-desc').textContent = suggestions[lowest[0]];
        }

        function selectMode(mode) {
            appData.mode = mode;
            document.querySelectorAll('.mode-card').forEach(card => card.classList.remove('selected'));
            document.querySelector(`[data-mode="${mode}"]`).classList.add('selected');
            
            const continueBtn = document.getElementById('mode-continue-btn');
            continueBtn.disabled = false;
            continueBtn.style.opacity = '1';
            continueBtn.textContent = `Continue with ${mode.charAt(0).toUpperCase() + mode.slice(1)} ▶`;
        }

        function goToModeSelection() {
            showScreen('mode-screen');
        }

        function goToWheelCheck() {
            if (appData.mode === 'recovery') {
                // Skip wheel check for recovery mode
                goToTaskPlanning();
            } else {
                showScreen('wheel-screen');
            }
        }

        function goToTaskPlanning() {
            showScreen('task-screen');
            
            // Update task suggestion based on mode and wheel
            const taskInput = document.getElementById('task-input');
            if (appData.mode === 'recovery') {
                taskInput.placeholder = 'Focus on rest and gentle activities. What would help you recharge?';
                taskInput.value = 'Rest, gentle self-care, maybe a short walk or relaxing activity';
            } else if (appData.mode === 'maintenance') {
                const lowest = Object.entries(appData.wheelRatings).reduce((a, b) => a[1] < b[1] ? a : b);
                const suggestions = {
                    space: 'Quick kitchen cleanup - dishes, counter wipe, maybe prep coffee for tomorrow',
                    body: 'Self-care routine - shower, grooming, light stretching',
                    love: 'Call family or spend quality time with partner',
                    security: 'Quick financial check or organize important documents',
                    purpose: 'Small progress on meaningful project',
                    joy: 'Something enjoyable - music, creative time, or favorite activity'
                };
                taskInput.value = suggestions[lowest[0]] || 'Focus on your lowest life area';
            }
        }

        function generateOutput() {
            appData.tasks = document.getElementById('task-input').value;
            
            const timestamp = new Date().toISOString().split('T')[0];
            const energySum = Object.values(appData.energy).reduce((a, b) => a + b, 0);
            const lowest = Object.entries(appData.wheelRatings).reduce((a, b) => a[1] < b[1] ? a : b);
            
            const output = `LOF Daily Check-In - ${timestamp}
=====================================

ENERGY ASSESSMENT:
Physical: ${appData.energy.physical}/5
Mental: ${appData.energy.mental}/5  
Emotional: ${appData.energy.emotional}/5
Mood: ${appData.energy.mood}/5
Total: ${energySum}/20

MODE: ${appData.mode.toUpperCase()}

WHEEL OF LIFE:
Body: ${appData.wheelRatings.body}/5
Space: ${appData.wheelRatings.space}/5
Love: ${appData.wheelRatings.love}/5
Security: ${appData.wheelRatings.security}/5
Purpose: ${appData.wheelRatings.purpose}/5
Joy: ${appData.wheelRatings.joy}/5
Lowest Area: ${lowest[0]} (${lowest[1]}/5)

TODAY'S FOCUS:
${appData.tasks}

--- Ready for C12 Analysis ---`;

            document.getElementById('output-text').textContent = output;
            showScreen('output-screen');
            
            // Auto-save to localStorage
            localStorage.setItem('lof-daily-data', JSON.stringify({
                ...appData,
                timestamp: timestamp,
                output: output
            }));
        }

        function copyToClipboard() {
            const output = document.getElementById('output-text').textContent;
            navigator.clipboard.writeText(output).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '✅ Copied!';
                btn.style.background = '#28a745';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#28a745';
                }, 2000);
            });
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function restart() {
            appData = {
                energy: { physical: 3, mental: 4, emotional: 2, mood: 3 },
                mode: '',
                wheelRatings: { body: 2, space: 1, love: 4, security: 3, purpose: 3, joy: 2 },
                tasks: '',
                session: 'morning'
            };
            
            // Reset UI to initial state
            showScreen('energy-screen');
            
            // Reset energy sliders
            document.querySelectorAll('.energy-fill').forEach((fill, index) => {
                const types = ['physical', 'mental', 'emotional', 'mood'];
                const value = Object.values(appData.energy)[index];
                fill.style.width = (value * 20) + '%';
                fill.textContent = value + '/5';
            });
            
            // Reset mode selection
            document.querySelectorAll('.mode-card').forEach(card => card.classList.remove('selected'));
            document.getElementById('mode-continue-btn').disabled = true;
            document.getElementById('mode-continue-btn').style.opacity = '0.5';
            document.getElementById('mode-continue-btn').textContent = 'Select Mode First';
            
            // Reset wheel ratings
            document.querySelectorAll('.wheel-rating').forEach(rating => {
                const area = rating.dataset.area;
                const value = appData.wheelRatings[area];
                const dots = rating.querySelectorAll('.wheel-dot');
                dots.forEach((dot, index) => {
                    dot.classList.toggle('filled', index < value);
                });
            });
            
            // Reset lowest area highlighting
            const lowest = Object.entries(appData.wheelRatings).reduce((a, b) => a[1] < b[1] ? a : b);
            document.querySelectorAll('.wheel-area').forEach(area => area.classList.remove('lowest'));
            document.querySelector(`[data-area="${lowest[0]}"]`).classList.add('lowest');
            
            // Clear task input
            document.getElementById('task-input').value = '';
            
            updateEnergySum();
        }

        function startEvening() {
            // Evening review mode - simpler flow for end-of-day reflection
            appData.session = 'evening';
            showEveningReview();
        }

        function showEveningReview() {
            // Create evening review screen dynamically
            const container = document.querySelector('.container');
            
            // Remove existing evening screen if it exists
            const existingEvening = document.getElementById('evening-screen');
            if (existingEvening) {
                existingEvening.remove();
            }
            
            const eveningHTML = `
                <div class="screen" id="evening-screen">
                    <div class="screen-title">How did today go?</div>
                    
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="summary-icon">✅</div>
                            <div class="summary-text">
                                <div class="summary-title">Tasks Completed</div>
                                <textarea class="task-input" placeholder="What did you actually accomplish?" style="min-height: 60px;"></textarea>
                            </div>
                        </div>

                        <div class="summary-item">
                            <div class="summary-icon">⚡</div>
                            <div class="summary-text">
                                <div class="summary-title">Energy Change</div>
                                <div style="display: flex; gap: 12px; margin-top: 8px;">
                                    <button class="mode-card" style="flex: 1; padding: 12px; font-size: 14px;" onclick="setEnergyChange('gained')">
                                        <div>📈 Gained</div>
                                    </button>
                                    <button class="mode-card" style="flex: 1; padding: 12px; font-size: 14px;" onclick="setEnergyChange('neutral')">
                                        <div>➡️ Neutral</div>
                                    </button>
                                    <button class="mode-card" style="flex: 1; padding: 12px; font-size: 14px;" onclick="setEnergyChange('drained')">
                                        <div>📉 Drained</div>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="summary-item">
                            <div class="summary-icon">💭</div>
                            <div class="summary-text">
                                <div class="summary-title">Thoughts & Patterns</div>
                                <textarea class="task-input" placeholder="Any insights, surprises, or patterns you noticed?" style="min-height: 60px;"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn" onclick="completeEvening()">Complete Day ▶</button>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', eveningHTML);
            showScreen('evening-screen');
        }

        function setEnergyChange(change) {
            appData.energyChange = change;
            
            // Update button selection
            const buttons = document.querySelectorAll('#evening-screen .mode-card');
            buttons.forEach(btn => btn.classList.remove('selected'));
            event.target.closest('.mode-card').classList.add('selected');
        }

        function completeEvening() {
            const completedTasks = document.querySelector('#evening-screen textarea').value;
            const insights = document.querySelectorAll('#evening-screen textarea')[1].value;
            
            const timestamp = new Date().toISOString().split('T')[0];
            
            const eveningOutput = `LOF Evening Review - ${timestamp}
=====================================

MORNING PLAN RECAP:
Energy: ${Object.values(appData.energy).reduce((a, b) => a + b, 0)}/20
Mode: ${appData.mode}
Planned Focus: ${appData.tasks}

ACTUAL RESULTS:
Completed: ${completedTasks}
Energy Change: ${appData.energyChange || 'Not specified'}

INSIGHTS:
${insights}

--- Complete Day Data for C12 ---`;

            document.getElementById('output-text').textContent = eveningOutput;
            showScreen('output-screen');
            
            // Save evening data
            const savedData = JSON.parse(localStorage.getItem('lof-daily-data') || '{}');
            savedData.evening = {
                completed: completedTasks,
                energyChange: appData.energyChange,
                insights: insights,
                timestamp: timestamp
            };
            localStorage.setItem('lof-daily-data', JSON.stringify(savedData));
        }

        // Auto-save progress periodically
        setInterval(() => {
            localStorage.setItem('lof-session-backup', JSON.stringify(appData));
        }, 30000); // Save every 30 seconds

        // Load saved session on page load
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('lof-session-backup');
            if (saved) {
                try {
                    const savedData = JSON.parse(saved);
                    // Only restore if it's from today
                    const today = new Date().toISOString().split('T')[0];
                    const savedDate = localStorage.getItem('lof-session-date');
                    
                    if (savedDate === today) {
                        appData = { ...appData, ...savedData };
                        // Update UI to reflect saved state
                        updateEnergySum();
                    }
                } catch (e) {
                    console.log('No valid saved session found');
                }
            }
            
            // Set today's date
            localStorage.setItem('lof-session-date', new Date().toISOString().split('T')[0]);
        });
    </script>
</body>
</html>
